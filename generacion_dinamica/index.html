<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestor de webs</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #999;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #f2f2f2;
    }
    #iframe {
      visibility: hidden;
      border: 2px solid #444;
      border-radius: 8px;
      margin-top: 10px;
    }
    form {
      margin-bottom: 20px;
      padding: 10px;
      background-color: #eef;
      border: 1px solid #99f;
      border-radius: 5px;
      width: fit-content;
    }
    label {
      margin-right: 10px;
    }
  </style>
</head>
<body>

  <h1>Listado de webs</h1>

  <!-- FORMULARIO DE NUEVAS WEBS -->
  <form id="formWeb">
    <label for="nombre">Nombre:</label>
    <input type="text" id="nombre" required>
    <label for="url">URL:</label>
    <input type="text" id="url" required placeholder="https://ejemplo.com">
    <button type="submit">Añadir Web</button>
  </form>

  <!-- TABLA -->
  <section id="contenedorTabla">
    <table>
      <thead>
        <tr>
          <th>Nombre</th>
          <th>URL</th>
          <th>Botones</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- IFRAME -->
  <section id="contenedorIframe">
    <iframe id="iframe" src="" frameborder="0"></iframe>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/JJKfTZg5IUo?si=gBqBnwsVzKNu8BUr" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/4GZtJaa29Xo?si=at-OdL8dGogWseB8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
  </section>

  <script>
    const tabla = document.querySelector("tbody");
    let webs = [];
    const iframe = document.getElementById("iframe");

    // Mostrar lista de webs en tabla
    function mostrarLista(webs) {
      let cadena = "";
      webs.forEach(web => {
        cadena += "<tr>";
        for (let clave in web) {
          cadena += `<td>${web[clave]}</td>`;
        }
        cadena += `<td><button class="btnVentana">Ventana</button></td>`;
        cadena += "</tr>";
      });
      tabla.innerHTML = cadena;

      // Asignar eventos a los botones
      let botonesVentana = document.querySelectorAll(".btnVentana");
      botonesVentana.forEach(boton => {
        boton.addEventListener("click", (e) => {
          const fila = e.target.closest("tr");
          let url = fila.children[1].textContent;
          iframe.width = "550px";
          iframe.height = "500px";
          iframe.src = url;
          iframe.style.visibility = "visible";
        });
      });
    }

    // Validar URL con regex
    function validarURL(url) {
      const regex = /^(https?:\/\/)([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}(\/\S*)?$/;
      return regex.test(url);
    }

    // Captura de formulario
    const form = document.getElementById("formWeb");
    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const nombre = document.getElementById("nombre").value.trim();
      const url = document.getElementById("url").value.trim();

      if (!validarURL(url)) {
        alert("❌ La URL no es válida. Debe comenzar por http:// o https://");
        return;
      }

      if (nombre === "") {
        alert("❌ El nombre no puede estar vacío.");
        return;
      }

      // Añadir nueva web al array y actualizar tabla
      webs.push({ nombre: nombre, enlace: url });
      mostrarLista(webs);

      // Limpiar formulario
      form.reset();
    });

    // Cargar JSON de webs iniciales
    fetch("webs.json")
      .then(res => res.json())
      .then(datos => {
        webs = datos;
        mostrarLista(webs);
      });
  </script>

</body>
</html>
